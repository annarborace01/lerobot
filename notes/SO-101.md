## On linux

- Install miniconda3 for virual environment management

```
mkdir -p ~/miniconda3
wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh -O ~/miniconda3/miniconda.sh
bash ~/miniconda3/miniconda.sh -b -u -p ~/miniconda3
rm ~/miniconda3/miniconda.sh
```

- Activate miniconda3 base

```
source ~/miniconda3/bin/activate
```

- Create LeRobot virtual env

```
conda create -y -n lerobot python=3.10
conda activate lerobot
conda install ffmpeg=7.1.1 -c conda-forge
```

- Clone LeRobot repo and install from source

```
git clone --branch v0.1 https://github.com/annarborace01/lerobot.git
cd lerobot
```

- Install from the source and also include feetech drivers

```
pip install -e ".[feetech]"
```


### First, let's first follow https://huggingface.co/docs/lerobot/so101

- Assembling takes time. The design is good but not perfect. Once assembled, it is really hard to disassemble it.
And inserting connectors to feetech motors is also a pain. So I recommend testing motors before assembling the arm.

- Find the device for the two robots
You can use `lerobot-find-port`. On linux, it is annoying that the first connected the device will be `/dev/ttyACM0`. It
you need to check for your arms every time. I think using MacOS is better in this case. Anyway, you might need to change 
device permissions. 
```
sudo chmod 666 /dev/ttyACM0
sudo chmod 666 /dev/ttyACM1
```

- Assume `/dev/ttyACM0` is the leader arm and `/dev/ttyACM1` is the follower

#### Follower
- Setup motors
```
lerobot-setup-motors \
    --robot.type=so101_follower \
    --robot.port=/dev/ttyACM1
```

- Calibrate motors
```
lerobot-calibrate \
    --robot.type=so101_follower \
    --robot.port=/dev/ttyACM1 \
    --robot.id=annarborace01_follower_arm 
```

```
INFO 2025-10-26 12:28:37 calibrate.py:73 {'robot': {'calibration_dir': None,
           'cameras': {},
           'disable_torque_on_disconnect': True,
           'id': 'annarborace01_follower_arm',
           'max_relative_target': None,
           'port': '/dev/ttyACM1',
           'use_degrees': False},
 'teleop': None}
INFO 2025-10-26 12:28:37 follower.py:104 annarborace01_follower_arm SO101Follower connected.
INFO 2025-10-26 12:28:37 follower.py:121 
Running calibration of annarborace01_follower_arm SO101Follower
Move annarborace01_follower_arm SO101Follower to the middle of its range of motion and press ENTER....
Move all joints sequentially through their entire ranges of motion.
Recording positions. Press ENTER to stop...

-------------------------------------------
-------------------------------------------
NAME            |    MIN |    POS |    MAX
shoulder_pan    |    631 |   2022 |   3363
shoulder_lift   |    900 |    903 |   3268
elbow_flex      |    899 |   3109 |   3117
wrist_flex      |    832 |    866 |   3204
wrist_roll      |    148 |   2178 |   3990
gripper         |   2018 |   2033 |   3497
Calibration saved to /home/xipengw/.cache/huggingface/lerobot/calibration/robots/so101_follower/annarborace01_follower_arm.json
INFO 2025-10-26 12:30:46 follower.py:230 annarborace01_follower_arm SO101Follower disconnected.
```

#### Leader

- Setup motors
```
lerobot-setup-motors \
    --teleop.type=so101_leader \
    --teleop.port=/dev/ttyACM0
```

- Calibrate motors
```
lerobot-calibrate \
    --teleop.type=so101_leader \
    --teleop.port=/dev/ttyACM0 \
    --teleop.id=annarborace01_leader_arm
```

```
INFO 2025-10-26 12:35:23 calibrate.py:73 {'robot': None,
 'teleop': {'calibration_dir': None,
            'id': 'annarborace01_leader_arm',
            'port': '/dev/ttyACM0',
            'use_degrees': False}}
INFO 2025-10-26 12:35:23 01_leader.py:82 annarborace01_leader_arm SO101Leader connected.
INFO 2025-10-26 12:35:23 01_leader.py:99 
Running calibration of annarborace01_leader_arm SO101Leader
Move annarborace01_leader_arm SO101Leader to the middle of its range of motion and press ENTER....
Move all joints sequentially through their entire ranges of motion.
Recording positions. Press ENTER to stop...

-------------------------------------------
-------------------------------------------
NAME            |    MIN |    POS |    MAX
shoulder_pan    |    801 |   2210 |   3487
shoulder_lift   |    920 |    928 |   3292
elbow_flex      |    801 |   3005 |   3009
wrist_flex      |    861 |    870 |   3199
wrist_roll      |    236 |   2160 |   4008
gripper         |   2026 |   2047 |   3277
Calibration saved to /home/xipengw/.cache/huggingface/lerobot/calibration/teleoperators/so101_leader/annarborace01_leader_arm.json
INFO 2025-10-26 12:36:57 1_leader.py:156 annarborace01_leader_arm SO101Leader disconnected.
```

#### Teleoperate:
```
lerobot-teleoperate \
    --robot.type=so101_follower \
    --robot.port=/dev/ttyACM1 \
    --robot.id=annarborace01_follower_arm \
    --teleop.type=so101_leader \
    --teleop.port=/dev/ttyACM0 \
    --teleop.id=annarborace01_leader_arm
```



## On Mac M chips

if you’re on macOS ARM, if you’re on macOS ARM:
```
conda install pytorch torchvision -c pytorch
```
```
python -c "import platform; print(platform.platform())"
```
If it shows:
`macOS-14.x-arm64-...`
✅ you’re running native Apple Silicon (good).

If it shows:
`macOS-14.x-x86_64-...`
⚠️ you’re running under Rosetta. You’ll need to create a new arm64 conda environment.
It is just that `pip install lerobot==0.4.0` might fail due to using an old torch version 

```
CONDA_SUBDIR=osx-arm64 conda create -n lerobot-arm python=3.10
conda activate lerobot-arm
conda install pytorch torchvision torchaudio -c pytorch -c conda-forge
```

Binaries are installed at
```
ls /Users/xipengwang/miniconda/envs/lerobot-arm/bin/lerobot-find-port
```

⚠️: You might need to change `Privacy & Security to allow accessories to Connect` to make sure you can find the control
board USB devices. 
```
ls  /dev/tty.usbmodem*
```

Might need to change:
```
sudo chmod 777 /dev/tty.usbmodem5A7C1166181 follower 
sudo chmod 777 /dev/tty.usbmodem5A7C1187781 leader
```

Set up so101_follower:
```
lerobot-setup-motors \
    --robot.type=so101_follower \
    --robot.port=/dev/tty.usbmodem5A7C1166181 
```
```
lerobot-calibrate \
    --robot.type=so101_follower \
    --robot.port=/dev/tty.usbmodem5A7C1166181 --robot.id=xipeng_follower_arm 
```


Set up so101_leader:
```
lerobot-setup-motors \
    --teleop.type=so101_leader --teleop.port=/dev/tty.usbmodem5A7C1187781 
```
```
lerobot-calibrate \
    --teleop.type=so101_leader  \
    --teleop.port=/dev/tty.usbmodem5A7C1187781 --teleop.id=xipeng_leader_arm 
```

Teleoperate:
```
lerobot-teleoperate \
    --robot.type=so101_follower \
    --robot.port=/dev/tty.usbmodem5A7C1166181 \
    --robot.id=xipeng_follower_arm \
    --teleop.type=so101_leader \
    --teleop.port=/dev/tty.usbmodem5A7C1187781 \
    --teleop.id=xipeng_leader_arm
```
